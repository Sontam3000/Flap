{"ast":null,"code":"'use client';\n\nimport React, { useRef, useState } from 'react';\nimport { useUncontrolled, useDidUpdate } from '@mantine/hooks';\nimport { getSize, getSpacing } from '../../core/utils/get-size/get-size.mjs';\nimport { createVarsResolver } from '../../core/styles-api/create-vars-resolver/create-vars-resolver.mjs';\nimport 'clsx';\nimport '../../core/MantineProvider/Mantine.context.mjs';\nimport '../../core/MantineProvider/default-theme.mjs';\nimport '../../core/MantineProvider/MantineProvider.mjs';\nimport '../../core/MantineProvider/MantineThemeProvider/MantineThemeProvider.mjs';\nimport { useProps } from '../../core/MantineProvider/use-props/use-props.mjs';\nimport { useStyles } from '../../core/styles-api/use-styles/use-styles.mjs';\nimport { Box } from '../../core/Box/Box.mjs';\nimport { factory } from '../../core/factory/factory.mjs';\nimport '../../core/DirectionProvider/DirectionProvider.mjs';\nimport { ColorSwatch } from '../ColorSwatch/ColorSwatch.mjs';\nimport { AlphaSlider } from './AlphaSlider/AlphaSlider.mjs';\nimport { ColorPickerProvider } from './ColorPicker.context.mjs';\nimport { convertHsvaTo } from './converters/converters.mjs';\nimport { parseColor, isColorValid } from './converters/parsers.mjs';\nimport { HueSlider } from './HueSlider/HueSlider.mjs';\nimport { Saturation } from './Saturation/Saturation.mjs';\nimport { Swatches } from './Swatches/Swatches.mjs';\nimport classes from './ColorPicker.module.css.mjs';\nconst defaultProps = {\n  swatchesPerRow: 7,\n  withPicker: true,\n  focusable: true,\n  size: \"md\",\n  __staticSelector: \"ColorPicker\"\n};\nconst varsResolver = createVarsResolver((_, _ref) => {\n  let {\n    size,\n    swatchesPerRow\n  } = _ref;\n  return {\n    wrapper: {\n      \"--cp-preview-size\": getSize(size, \"cp-preview-size\"),\n      \"--cp-width\": getSize(size, \"cp-width\"),\n      \"--cp-body-spacing\": getSpacing(size),\n      \"--cp-swatch-size\": \"\".concat(100 / swatchesPerRow, \"%\"),\n      \"--cp-thumb-size\": getSize(size, \"cp-thumb-size\"),\n      \"--cp-saturation-height\": getSize(size, \"cp-saturation-height\")\n    }\n  };\n});\nconst ColorPicker = factory((_props, ref) => {\n  const props = useProps(\"ColorPicker\", defaultProps, _props);\n  const {\n    classNames,\n    className,\n    style,\n    styles,\n    unstyled,\n    vars,\n    format,\n    value,\n    defaultValue,\n    onChange,\n    onChangeEnd,\n    withPicker,\n    size,\n    saturationLabel,\n    hueLabel,\n    alphaLabel,\n    focusable,\n    swatches,\n    swatchesPerRow,\n    fullWidth,\n    onColorSwatchClick,\n    __staticSelector,\n    mod,\n    ...others\n  } = props;\n  const getStyles = useStyles({\n    name: __staticSelector,\n    props,\n    classes,\n    className,\n    style,\n    classNames,\n    styles,\n    unstyled,\n    rootSelector: \"wrapper\",\n    vars,\n    varsResolver\n  });\n  const formatRef = useRef(format);\n  const valueRef = useRef();\n  const scrubTimeoutRef = useRef(-1);\n  const isScrubbingRef = useRef(false);\n  const withAlpha = format === \"hexa\" || format === \"rgba\" || format === \"hsla\";\n  const [_value, setValue, controlled] = useUncontrolled({\n    value,\n    defaultValue,\n    finalValue: \"#FFFFFF\",\n    onChange\n  });\n  const [parsed, setParsed] = useState(parseColor(_value));\n  const startScrubbing = () => {\n    window.clearTimeout(scrubTimeoutRef.current);\n    isScrubbingRef.current = true;\n  };\n  const stopScrubbing = () => {\n    window.clearTimeout(scrubTimeoutRef.current);\n    scrubTimeoutRef.current = window.setTimeout(() => {\n      isScrubbingRef.current = false;\n    }, 200);\n  };\n  const handleChange = color => {\n    setParsed(current => {\n      const next = {\n        ...current,\n        ...color\n      };\n      valueRef.current = convertHsvaTo(formatRef.current, next);\n      return next;\n    });\n    setValue(valueRef.current);\n  };\n  useDidUpdate(() => {\n    if (isColorValid(value) && !isScrubbingRef.current) {\n      setParsed(parseColor(value));\n    }\n  }, [value]);\n  useDidUpdate(() => {\n    formatRef.current = format;\n    setValue(convertHsvaTo(format, parsed));\n  }, [format]);\n  return /* @__PURE__ */React.createElement(ColorPickerProvider, {\n    value: {\n      getStyles,\n      unstyled\n    }\n  }, /* @__PURE__ */React.createElement(Box, {\n    ref,\n    ...getStyles(\"wrapper\"),\n    size,\n    mod: [{\n      \"full-width\": fullWidth\n    }, mod],\n    ...others\n  }, withPicker && /* @__PURE__ */React.createElement(React.Fragment, null, /* @__PURE__ */React.createElement(Saturation, {\n    value: parsed,\n    onChange: handleChange,\n    onChangeEnd: _ref2 => {\n      let {\n        s,\n        v\n      } = _ref2;\n      return onChangeEnd === null || onChangeEnd === void 0 ? void 0 : onChangeEnd(convertHsvaTo(formatRef.current, {\n        ...parsed,\n        s,\n        v\n      }));\n    },\n    color: _value,\n    size,\n    focusable,\n    saturationLabel,\n    onScrubStart: startScrubbing,\n    onScrubEnd: stopScrubbing\n  }), /* @__PURE__ */React.createElement(\"div\", {\n    ...getStyles(\"body\")\n  }, /* @__PURE__ */React.createElement(\"div\", {\n    ...getStyles(\"sliders\")\n  }, /* @__PURE__ */React.createElement(HueSlider, {\n    value: parsed.h,\n    onChange: h => handleChange({\n      h\n    }),\n    onChangeEnd: h => onChangeEnd === null || onChangeEnd === void 0 ? void 0 : onChangeEnd(convertHsvaTo(formatRef.current, {\n      ...parsed,\n      h\n    })),\n    size,\n    focusable,\n    \"aria-label\": hueLabel,\n    onScrubStart: startScrubbing,\n    onScrubEnd: stopScrubbing\n  }), withAlpha && /* @__PURE__ */React.createElement(AlphaSlider, {\n    value: parsed.a,\n    onChange: a => handleChange({\n      a\n    }),\n    onChangeEnd: a => {\n      onChangeEnd === null || onChangeEnd === void 0 ? void 0 : onChangeEnd(convertHsvaTo(formatRef.current, {\n        ...parsed,\n        a\n      }));\n    },\n    size,\n    color: convertHsvaTo(\"hex\", parsed),\n    focusable,\n    \"aria-label\": alphaLabel,\n    onScrubStart: startScrubbing,\n    onScrubEnd: stopScrubbing\n  })), withAlpha && /* @__PURE__ */React.createElement(ColorSwatch, {\n    color: _value,\n    radius: \"sm\",\n    size: \"var(--cp-preview-size)\",\n    ...getStyles(\"preview\")\n  }))), Array.isArray(swatches) && /* @__PURE__ */React.createElement(Swatches, {\n    data: swatches,\n    swatchesPerRow,\n    focusable,\n    setValue,\n    onChangeEnd: color => {\n      const convertedColor = convertHsvaTo(format, parseColor(color));\n      onColorSwatchClick === null || onColorSwatchClick === void 0 ? void 0 : onColorSwatchClick(convertedColor);\n      onChangeEnd === null || onChangeEnd === void 0 ? void 0 : onChangeEnd(convertedColor);\n      if (!controlled) {\n        setParsed(parseColor(color));\n      }\n    }\n  })));\n});\nColorPicker.classes = classes;\nColorPicker.displayName = \"@mantine/core/ColorPicker\";\nexport { ColorPicker };","map":null,"metadata":{},"sourceType":"module"}