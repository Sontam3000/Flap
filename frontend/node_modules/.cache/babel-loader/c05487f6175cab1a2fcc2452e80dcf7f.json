{"ast":null,"code":"'use client';\n\nimport React, { useEffect } from 'react';\nimport { useId, useUncontrolled } from '@mantine/hooks';\nimport 'clsx';\nimport { useResolvedStylesApi } from '../../core/styles-api/use-resolved-styles-api/use-resolved-styles-api.mjs';\nimport { useStyles } from '../../core/styles-api/use-styles/use-styles.mjs';\nimport '../../core/MantineProvider/Mantine.context.mjs';\nimport '../../core/MantineProvider/default-theme.mjs';\nimport '../../core/MantineProvider/MantineProvider.mjs';\nimport '../../core/MantineProvider/MantineThemeProvider/MantineThemeProvider.mjs';\nimport { useProps } from '../../core/MantineProvider/use-props/use-props.mjs';\nimport { extractStyleProps } from '../../core/Box/style-props/extract-style-props/extract-style-props.mjs';\nimport '../../core/Box/Box.mjs';\nimport { factory } from '../../core/factory/factory.mjs';\nimport '../../core/DirectionProvider/DirectionProvider.mjs';\nimport { getParsedComboboxData } from '../Combobox/get-parsed-combobox-data/get-parsed-combobox-data.mjs';\nimport { getOptionsLockup } from '../Combobox/get-options-lockup/get-options-lockup.mjs';\nimport '../Combobox/ComboboxChevron/ComboboxChevron.mjs';\nimport { Combobox } from '../Combobox/Combobox.mjs';\nimport '../Combobox/ComboboxDropdown/ComboboxDropdown.mjs';\nimport '../Combobox/ComboboxOptions/ComboboxOptions.mjs';\nimport '../Combobox/ComboboxOption/ComboboxOption.mjs';\nimport '../Combobox/ComboboxTarget/ComboboxTarget.mjs';\nimport '../Combobox/ComboboxSearch/ComboboxSearch.mjs';\nimport '../Combobox/ComboboxEmpty/ComboboxEmpty.mjs';\nimport '../Combobox/ComboboxFooter/ComboboxFooter.mjs';\nimport '../Combobox/ComboboxHeader/ComboboxHeader.mjs';\nimport '../Combobox/ComboboxEventsTarget/ComboboxEventsTarget.mjs';\nimport '../Combobox/ComboboxDropdownTarget/ComboboxDropdownTarget.mjs';\nimport '../Combobox/ComboboxGroup/ComboboxGroup.mjs';\nimport '../Combobox/ComboboxClearButton/ComboboxClearButton.mjs';\nimport { OptionsDropdown } from '../Combobox/OptionsDropdown/OptionsDropdown.mjs';\nimport { useCombobox } from '../Combobox/use-combobox/use-combobox.mjs';\nimport '../Combobox/Combobox.context.mjs';\nimport { InputBase } from '../InputBase/InputBase.mjs';\nimport { Pill } from '../Pill/Pill.mjs';\nimport '../Pill/PillGroup/PillGroup.mjs';\nimport { PillsInput } from '../PillsInput/PillsInput.mjs';\nimport '../PillsInput/PillsInputField/PillsInputField.mjs';\nimport { filterPickedValues } from './filter-picked-values.mjs';\nconst defaultProps = {\n  maxValues: Infinity,\n  withCheckIcon: true,\n  checkIconPosition: \"left\",\n  hiddenInputValuesDivider: \",\"\n};\nconst MultiSelect = factory((_props, ref) => {\n  const props = useProps(\"MultiSelect\", defaultProps, _props);\n  const {\n    classNames,\n    className,\n    style,\n    styles,\n    unstyled,\n    vars,\n    size,\n    value,\n    defaultValue,\n    onChange,\n    onKeyDown,\n    variant,\n    data,\n    dropdownOpened,\n    defaultDropdownOpened,\n    onDropdownOpen,\n    onDropdownClose,\n    selectFirstOptionOnChange,\n    onOptionSubmit,\n    comboboxProps,\n    filter,\n    limit,\n    withScrollArea,\n    maxDropdownHeight,\n    searchValue,\n    defaultSearchValue,\n    onSearchChange,\n    readOnly,\n    disabled,\n    onFocus,\n    onBlur,\n    onPaste,\n    radius,\n    rightSection,\n    rightSectionWidth,\n    rightSectionPointerEvents,\n    rightSectionProps,\n    leftSection,\n    leftSectionWidth,\n    leftSectionPointerEvents,\n    leftSectionProps,\n    inputContainer,\n    inputWrapperOrder,\n    withAsterisk,\n    labelProps,\n    descriptionProps,\n    errorProps,\n    wrapperProps,\n    description,\n    label,\n    error,\n    maxValues,\n    searchable,\n    nothingFoundMessage,\n    withCheckIcon,\n    checkIconPosition,\n    hidePickedOptions,\n    withErrorStyles,\n    name,\n    form,\n    id,\n    clearable,\n    clearButtonProps,\n    hiddenInputProps,\n    placeholder,\n    hiddenInputValuesDivider,\n    required,\n    mod,\n    ...others\n  } = props;\n  const _id = useId(id);\n  const parsedData = getParsedComboboxData(data);\n  const optionsLockup = getOptionsLockup(parsedData);\n  const combobox = useCombobox({\n    opened: dropdownOpened,\n    defaultOpened: defaultDropdownOpened,\n    onDropdownOpen,\n    onDropdownClose: () => {\n      onDropdownClose === null || onDropdownClose === void 0 ? void 0 : onDropdownClose();\n      combobox.resetSelectedOption();\n    }\n  });\n  const {\n    styleProps,\n    rest: {\n      type,\n      ...rest\n    }\n  } = extractStyleProps(others);\n  const [_value, setValue] = useUncontrolled({\n    value,\n    defaultValue,\n    finalValue: [],\n    onChange\n  });\n  const [_searchValue, setSearchValue] = useUncontrolled({\n    value: searchValue,\n    defaultValue: defaultSearchValue,\n    finalValue: \"\",\n    onChange: onSearchChange\n  });\n  const getStyles = useStyles({\n    name: \"MultiSelect\",\n    classes: {},\n    props,\n    classNames,\n    styles,\n    unstyled\n  });\n  const {\n    resolvedClassNames,\n    resolvedStyles\n  } = useResolvedStylesApi({\n    props,\n    styles,\n    classNames\n  });\n  const handleInputKeydown = event => {\n    onKeyDown === null || onKeyDown === void 0 ? void 0 : onKeyDown(event);\n    if (event.key === \" \" && !searchable) {\n      event.preventDefault();\n      combobox.toggleDropdown();\n    }\n    if (event.key === \"Backspace\" && _searchValue.length === 0 && _value.length > 0) {\n      setValue(_value.slice(0, _value.length - 1));\n    }\n  };\n  const values = _value.map((item, index) => {\n    var _optionsLockup$item, _optionsLockup$item2;\n    return /* @__PURE__ */React.createElement(Pill, {\n      key: \"\".concat(item, \"-\").concat(index),\n      withRemoveButton: !readOnly && !((_optionsLockup$item = optionsLockup[item]) === null || _optionsLockup$item === void 0 ? void 0 : _optionsLockup$item.disabled),\n      onRemove: () => setValue(_value.filter(i => item !== i)),\n      unstyled,\n      ...getStyles(\"pill\")\n    }, ((_optionsLockup$item2 = optionsLockup[item]) === null || _optionsLockup$item2 === void 0 ? void 0 : _optionsLockup$item2.label) || item);\n  });\n  useEffect(() => {\n    if (selectFirstOptionOnChange) {\n      combobox.selectFirstOption();\n    }\n  }, [selectFirstOptionOnChange, _value]);\n  const clearButton = clearable && _value.length > 0 && !disabled && !readOnly && /* @__PURE__ */React.createElement(Combobox.ClearButton, {\n    size,\n    ...clearButtonProps,\n    onClear: () => {\n      setValue([]);\n      setSearchValue(\"\");\n    }\n  });\n  const filteredData = filterPickedValues({\n    data: parsedData,\n    value: _value\n  });\n  return /* @__PURE__ */React.createElement(React.Fragment, null, /* @__PURE__ */React.createElement(Combobox, {\n    store: combobox,\n    classNames: resolvedClassNames,\n    styles: resolvedStyles,\n    unstyled,\n    size,\n    readOnly,\n    __staticSelector: \"MultiSelect\",\n    onOptionSubmit: val => {\n      onOptionSubmit === null || onOptionSubmit === void 0 ? void 0 : onOptionSubmit(val);\n      setSearchValue(\"\");\n      combobox.updateSelectedOptionIndex(\"selected\");\n      if (_value.includes(optionsLockup[val].value)) {\n        setValue(_value.filter(v => v !== optionsLockup[val].value));\n      } else if (_value.length < maxValues) {\n        setValue([..._value, optionsLockup[val].value]);\n      }\n    },\n    ...comboboxProps\n  }, /* @__PURE__ */React.createElement(Combobox.DropdownTarget, null, /* @__PURE__ */React.createElement(PillsInput, {\n    ...styleProps,\n    __staticSelector: \"MultiSelect\",\n    classNames: resolvedClassNames,\n    styles: resolvedStyles,\n    unstyled,\n    size,\n    className,\n    style,\n    variant,\n    disabled,\n    radius,\n    rightSection: rightSection || clearButton || /* @__PURE__ */React.createElement(Combobox.Chevron, {\n      size,\n      error,\n      unstyled\n    }),\n    rightSectionPointerEvents: rightSectionPointerEvents || (clearButton ? \"all\" : \"none\"),\n    rightSectionWidth,\n    rightSectionProps,\n    leftSection,\n    leftSectionWidth,\n    leftSectionPointerEvents,\n    leftSectionProps,\n    inputContainer,\n    inputWrapperOrder,\n    withAsterisk,\n    labelProps,\n    descriptionProps,\n    errorProps,\n    wrapperProps,\n    description,\n    label,\n    error,\n    multiline: true,\n    withErrorStyles,\n    __stylesApiProps: {\n      ...props,\n      rightSectionPointerEvents: rightSectionPointerEvents || (clearButton ? \"all\" : \"none\"),\n      multiline: true\n    },\n    pointer: !searchable,\n    onClick: () => searchable ? combobox.openDropdown() : combobox.toggleDropdown(),\n    \"data-expanded\": combobox.dropdownOpened || void 0,\n    id: _id,\n    required,\n    mod\n  }, /* @__PURE__ */React.createElement(Pill.Group, {\n    disabled,\n    unstyled,\n    ...getStyles(\"pillsList\")\n  }, values, /* @__PURE__ */React.createElement(Combobox.EventsTarget, null, /* @__PURE__ */React.createElement(PillsInput.Field, {\n    ...rest,\n    ref,\n    id: _id,\n    placeholder,\n    type: !searchable && !placeholder ? \"hidden\" : \"visible\",\n    ...getStyles(\"inputField\"),\n    unstyled,\n    onFocus: event => {\n      onFocus === null || onFocus === void 0 ? void 0 : onFocus(event);\n      searchable && combobox.openDropdown();\n    },\n    onBlur: event => {\n      onBlur === null || onBlur === void 0 ? void 0 : onBlur(event);\n      combobox.closeDropdown();\n      setSearchValue(\"\");\n    },\n    onKeyDown: handleInputKeydown,\n    value: _searchValue,\n    onChange: event => {\n      setSearchValue(event.currentTarget.value);\n      searchable && combobox.openDropdown();\n      selectFirstOptionOnChange && combobox.selectFirstOption();\n    },\n    disabled,\n    readOnly: readOnly || !searchable,\n    pointer: !searchable\n  }))))), /* @__PURE__ */React.createElement(OptionsDropdown, {\n    data: hidePickedOptions ? filteredData : parsedData,\n    hidden: readOnly || disabled,\n    filter,\n    search: _searchValue,\n    limit,\n    hiddenWhenEmpty: !searchable || !nothingFoundMessage || hidePickedOptions && filteredData.length === 0 && _searchValue.trim().length === 0,\n    withScrollArea,\n    maxDropdownHeight,\n    filterOptions: searchable,\n    value: _value,\n    checkIconPosition,\n    withCheckIcon,\n    nothingFoundMessage,\n    unstyled,\n    labelId: \"\".concat(_id, \"-label\")\n  })), /* @__PURE__ */React.createElement(\"input\", {\n    type: \"hidden\",\n    name,\n    value: _value.join(hiddenInputValuesDivider),\n    form,\n    disabled,\n    ...hiddenInputProps\n  }));\n});\nMultiSelect.classes = {\n  ...InputBase.classes,\n  ...Combobox.classes\n};\nMultiSelect.displayName = \"@mantine/core/MultiSelect\";\nexport { MultiSelect };","map":null,"metadata":{},"sourceType":"module"}